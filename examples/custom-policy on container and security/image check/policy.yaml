apiVersion: v1
policies:
  - name: image_check_container
    isDefault: true
    rules:
      - identifier: IMAGE_CHECK_CONTAINER
        messageOnFailure: ""

customRules:
  - identifier: IMAGE_CHECK_CONTAINER
    name: Ensure that the container has proper image['ubuntu']
    defaultMessageOnFailure: Please ensure that you have proper operating system to your respective container
    schema:
      properties:
        spec:
          properties:
            containers:
              type: array
              items:
                properties:
                  image:
                    type: string
                    enum:
                      - ubuntu
                required:
                  - image
          required:
            - containers
